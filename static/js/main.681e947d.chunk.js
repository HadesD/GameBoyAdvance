(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){e.exports=n.p+"static/media/game-boy-advance.ddd93e7f.svg"},109:function(e,t,n){"use strict";(function(e){var a=n(9),i=n(10),o=n(110),r=n(75),s=n.n(r),u=n(115),c=function(){function t(e){Object(a.a)(this,t),console.log("EmulatorManager.constructor called"),this.parent=e,this.apiReady={GB:!!window.amebo,GBA:!!window.gbaninja},this.keyCodes={A:1,B:2,SELECT:3,START:4,RIGHT:5,LEFT:6,UP:7,DOWN:8,R:9,L:10},this.pressedKeyList={},this.gameType={GB:1,GBA:2},this.rom={codeName:null,fileName:null,gameType:null,buffer:null},this.emuApi=null,this.isPaused=!0}return Object(i.a)(t,[{key:"start",value:function(){this.keyboardManager=this.parent.parent.keyboardManager;var e=this;this.apiReady.GB||s()("".concat("/GameBoyAdvance","/lib/amebo.js"),function(t,n){t?console.error(t):e.apiReady.GB=!0}),this.apiReady.GBA||s()("".concat("/GameBoyAdvance","/lib/gbaninja.js"),function(t,n){t?console.error(t):e.apiReady.GBA=!0})}},{key:"destroy",value:function(){this.emuApi&&this.emuApi.destroy()}},{key:"isKeyPressed",value:function(e){var t=this.keyCodes[e];return!!t&&this.pressedKeyList[t]}},{key:"releaseAllKey",value:function(){for(var e=Object.keys(this.keyCodes),t=0;t<e.length;t++)this.onReleased(e[t])}},{key:"isGBRom",value:function(e){return"ce,ed,66,66,cc,d,0,b"===[e[260],e[261],e[262],e[263],e[264],e[265],e[266],e[267]].map(function(e){return e.toString(16)}).join()}},{key:"getRomName",value:function(){for(var e=this.rom.gameType===this.gameType.GBA?160:308,t=e+16,n="",a=e;a<t;a++){var i=this.rom.buffer[a];if(128===i||192===i||0===i)break;n+=String.fromCharCode(i)}return n}},{key:"isGBARom",value:function(e){return!0}},{key:"loadRomBuffer",value:function(e){if(-1!==this.rom.fileName.indexOf(".gb")){this.rom.buffer=e instanceof ArrayBuffer?new Uint8Array(e):e,this.destroy();for(var t=this.parent.refs.screen;t.hasChildNodes();)t.removeChild(t.lastChild);var n=document.createElement("canvas");t.appendChild(n),this.isGBRom(this.rom.buffer)?(this.rom.gameType=this.gameType.GB,this.emuApi=new window.amebo(n),this.emuApi.keyConfig=this.keyboardManager.keyMapConfig,this.emuApi.loadROMBuffer(this.rom.buffer)):this.isGBARom(e)&&(this.rom.gameType=this.gameType.GBA,this.emuApi=new u.a(n),this.emuApi.emulatorManager=this,this.emuApi.setRomBuffer(this.rom.buffer)),this.rom.codeName=this.getRomName(),this.emuApi.start(),this.isPaused=!1,console.log(this.rom)}}},{key:"loadRomUrl",value:function(e){var t=new XMLHttpRequest;t.open("GET",e),t.responseType="arraybuffer",t.onload=function(e){console.log(e)},t.send()}},{key:"loadRomFile",value:function(e){var t=this,n=new FileReader;n.onload=function(n){var a=n.target.result;-1===e.name.indexOf(".zip")?(t.rom.fileName=e.name,t.loadRomBuffer(a)):t.loadRomZipFile(a)},n.readAsArrayBuffer(e)}},{key:"loadRomZipFile",value:function(t){for(var n=new o.Zlib.Unzip(new e(t)),a=n.getFilenames(),i=0;i<a.length;i++){var r=a[i];if(-1!==r.indexOf(".gb")){this.rom.fileName=r,this.loadRomBuffer(n.decompress(r));break}}}},{key:"onPressed",value:function(e){if(!this.isPaused){var t=this.keyCodes[e];t&&(this.pressedKeyList[t]=!0,console.log("onPressed: %s",e),this.updateKeyState(e,this.pressedKeyList[t]))}}},{key:"onReleased",value:function(e){if(!this.isPaused){var t=this.keyCodes[e];t&&(this.pressedKeyList[t]=!1,console.log("onRelease: %s",e),this.updateKeyState(e,this.pressedKeyList[t]))}}},{key:"updateKeyState",value:function(e,t){switch(this.rom.gameType){case this.gameType.GB:this.emuApi.keysArray[this.keyboardManager.keyMapConfig[e]]=t?0:1;break;case this.gameType.GBA:break;default:return}}},{key:"pause",value:function(){this.isPaused=!0}}]),t}();t.a=c}).call(this,n(193).Buffer)},111:function(e,t,n){e.exports=n.p+"static/media/emu-canvas-bg.2a9ac588.svg"},112:function(e,t,n){e.exports=n.p+"static/media/dpad.296e73f9.svg"},113:function(e,t,n){e.exports=n.p+"static/media/gba-console-landscape.a7b93da5.svg"},114:function(e,t,n){e.exports=n.p+"static/media/emu-background.0371e715.svg"},115:function(e,t,n){"use strict";var a={compileShader:function(e,t,n){var a=e.createShader(n);if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new Error("could not compile shader:"+e.getShaderInfoLog(a));return a},createProgram:function(e,t,n){var a=e.createProgram();if(e.attachShader(a,t),e.attachShader(a,n),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Error("program filed to link:"+e.getProgramInfoLog(a));return a},createShaderFromScript:function(e,t,n){var a=document.getElementById(t),i=a.text;if(!n)if("x-shader/x-vertex"===a.type)n=e.VERTEX_SHADER;else{if("x-shader/x-fragment"!==a.type)throw new Error("Unreachable");n=e.FRAGMENT_SHADER}return this.compileShader(e,i,n)},createProgramFromScripts:function(e,t,n){var a=this.createShaderFromScript(e,t),i=this.createShaderFromScript(e,n);return this.createProgram(e,a,i)},createTexture:function(e,t){var n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);var a=new Uint16Array(t*t);return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,t,0,e.RGBA,e.UNSIGNED_SHORT_5_5_5_1,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),n},updateTexture:function(e,t,n,a,i){e.bindTexture(e.TEXTURE_2D,t),e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,a,e.RGBA,e.UNSIGNED_SHORT_5_5_5_1,i)},createFullscreenQuad:function(e,t,n){var a=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,new Float32Array([t,t,n,t,t,n,t,n,n,t,n,n]),e.STATIC_DRAW),a}},i=240,o=160;function r(e,t){this.emscriptenModule=e,this.canvas=t,this.totalFrames=0,this.lastFrameTime=window.performance.now(),this.gl=null,this.fullscreenQuadBuffer=null,this.texture=null,this.shaderProgram=null,this.positionLocation=null,this.textureSamplerLocation=null,this.pixels=new Uint16Array(i*o)}r.prototype=Object.create(Object.prototype),r.prototype.constructor=r,r.prototype.initScreen=function(){return this.gl=this.canvas.getContext("webgl",{alpha:!1})||this.canvas.getContext("experimental-webgl",{alpha:!1}),!!this.gl&&(this.shaderProgram=a.createProgramFromScripts(this.gl,"2d-vertex-shader","2d-fragment-shader"),this.texture=a.createTexture(this.gl,256),this.fullscreenQuadBuffer=a.createFullscreenQuad(this.gl,0,1),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"a_position"),this.textureSamplerLocation=this.gl.getUniformLocation(this.shaderProgram,"u_sampler"),!0)},r.prototype.drawGBAFrame=function(e){window.hasRequestedFrameButNotRendered=!1,this.lastFrameTime=window.performance.now();for(var t=e/2,n=this.emscriptenModule.HEAP16,r=0;r<this.pixels.length;r++)this.pixels[r]=n[t+r];a.updateTexture(this.gl,this.texture,i,o,this.pixels),this.drawFrame(),this.totalFrames++},r.prototype.drawFrame=function(){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.fullscreenQuadBuffer),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.uniform1i(this.textureSamplerLocation,0),this.gl.drawArrays(this.gl.TRIANGLES,0,6)},r.prototype.onResize=function(){var e=this.canvas;e.width=e.clientWidth,e.height=e.clientHeight,this.gl.viewport(0,0,e.width,e.height)},r.prototype.destroy=function(){};var s=r;function u(e){this.emscriptenModule=e,this.audioCtx=new window.AudioContext,this.audioChannels=2,this.audioScriptNode=this.audioCtx.createScriptProcessor(512,2),this.audioScriptNode.onaudioprocess=this.handleAudioEvent.bind(this),this.audioScriptNode.connect(this.audioCtx.destination),this.audioSpareSamplesRingBuffer=new Int16Array(16384),this.audioSpareWritePtr=0,this.audioSpareReadPtr=0,this.spareSamplesAtLastEvent=0;var t=this;window.addEventListener("touchstart",function(e){var n=t.audioCtx.createBuffer(1,1,22050),a=t.audioCtx.createBufferSource();a.buffer=n,a.connect(t.audioCtx.destination),a.start(0)},!1)}function c(e){this.emscriptenModule=e}u.prototype=Object.create(Object.prototype),u.prototype.constructor=u,u.prototype.getSampleRate=function(){return this.audioCtx.sampleRate},u.prototype.currentAudioTime=function(){return this.audioCtx.currentTime},u.prototype.getNumExtraSamples=function(){var e=this.audioSpareWritePtr-this.audioSpareReadPtr;return e>=0?e:e+this.audioSpareSamplesRingBuffer.length},u.prototype.resetSound=function(){},u.prototype.writeSound=function(e,t){if(e%2!==1)if(t%2===0){var n,a=e>>1,i=this.emscriptenModule.HEAP16;for(n=0;n<t;n++)this.audioSpareSamplesRingBuffer[this.audioSpareWritePtr]=i[a+n],this.audioSpareWritePtr++,this.audioSpareWritePtr>=this.audioSpareSamplesRingBuffer.length&&(this.audioSpareWritePtr=0)}else console.error("Number of audio samples must be even.");else console.error("Audio pointer must be 16 bit aligned.")},u.prototype.handleAudioEvent=function(e){if(window.gbaninja&&window.VBAInterface&&window.VBAInterface.VBA_get_emulating()){var t,n,a=[],i=e.outputBuffer.numberOfChannels,o=e.outputBuffer.length;for(t=0;t<i;t++)a.push(e.outputBuffer.getChannelData(t));for(t=0;t<o;t++)for(n=0;n<i;n++)this.audioSpareReadPtr===this.audioSpareWritePtr?a[n][t]=0:(a[n][t]=this.audioSpareSamplesRingBuffer[this.audioSpareReadPtr]/16384,this.audioSpareReadPtr++,this.audioSpareReadPtr>=this.audioSpareSamplesRingBuffer.length&&(this.audioSpareReadPtr-=this.audioSpareSamplesRingBuffer.length));this.spareSamplesAtLastEvent=this.getNumExtraSamples()}},c.prototype=Object.create(Object.prototype),c.prototype.constructor=c,c.prototype.getSampleRate=function(){return 44100},c.prototype.currentAudioTime=function(){return Date.now()/1e3},c.prototype.getNumExtraSamples=function(){return 0},c.prototype.resetSound=function(){},c.prototype.writeSound=function(){},c.prototype.handleAudioEvent=function(){};var l=u;t.a=function(e){var t=window.gbaninja;window.VBAInterface=this,this.vbaGraphics=new s(t,e);var n=16777216,a=window.performance.now(),i=null,o=this,r=t;function u(){var e=window.performance.now(),t=e-a;if(t>=.1){var r=Math.min(50,t),s=Math.floor(n/(1e3/r));o.vbaSound.spareSamplesAtLastEvent>1e3&&(s-=Math.floor(Math.min(.03*s,n/1e4))),o.vbaSound.spareSamplesAtLastEvent<700&&(s+=Math.floor(Math.min(.03*s,n/1e4))),o.VBA_do_cycles(s),a=e}i=window.requestAnimationFrame(u)}this.setRomBuffer=function(e){this.romBuffer8=e},this.VBA_get_emulating=function(){return r.ccall("VBA_get_emulating","int",[],[])},this.VBA_start=function(){return r.ccall("VBA_start","int",[],[])},this.VBA_do_cycles=function(e){return r.ccall("VBA_do_cycles","int",["int"],[e])},this.VBA_stop=function(){return r.ccall("VBA_stop","int",[],[])},this.VBA_get_bios=function(){return r.ccall("VBA_get_bios","int",[],[])},this.VBA_get_rom=function(){return r.ccall("VBA_get_rom","int",[],[])},this.VBA_get_internalRAM=function(){return r.ccall("VBA_get_internalRAM","int",[],[])},this.VBA_get_workRAM=function(){return r.ccall("VBA_get_workRAM","int",[],[])},this.VBA_get_paletteRAM=function(){return r.ccall("VBA_get_paletteRAM","int",[],[])},this.VBA_get_vram=function(){return r.ccall("VBA_get_vram","int",[],[])},this.VBA_get_pix=function(){return r.ccall("VBA_get_pix","int",[],[])},this.VBA_get_oam=function(){return r.ccall("VBA_get_oam","int",[],[])},this.VBA_get_ioMem=function(){return r.ccall("VBA_get_ioMem","int",[],[])},this.VBA_get_systemColorMap16=function(){return r.ccall("VBA_get_systemColorMap16","int",[],[])},this.VBA_get_systemColorMap32=function(){return r.ccall("VBA_get_systemColorMap32","int",[],[])},this.VBA_get_systemFrameSkip=function(){return r.ccall("VBA_get_systemFrameSkip","int",[],[])},this.VBA_set_systemFrameSkip=function(e){return r.ccall("VBA_set_systemFrameSkip","int",["int"],[e])},this.VBA_get_systemSaveUpdateCounter=function(){return r.ccall("VBA_get_systemSaveUpdateCounter","int",[],[])},this.VBA_reset_systemSaveUpdateCounter=function(){return r.ccall("VBA_reset_systemSaveUpdateCounter","int",[],[])},this.VBA_emuWriteBattery=function(){return r.ccall("VBA_emuWriteBattery","int",[],[])},this.VBA_agbPrintFlush=function(){return r.ccall("VBA_agbPrintFlush","int",[],[])},this.NYI=function(e){console.log("Feature is NYI: ",e)},this.getAudioSampleRate=function(){return this.vbaSound.getSampleRate()},this.getRomSize=function(e){return this.romBuffer8.byteLength},this.copyRomToMemory=function(e){for(var t=r.HEAP8,n=this.romBuffer8.byteLength,a=0;a<n;a++)t[e+a]=this.romBuffer8[a]},this.renderFrame=function(e){this.vbaGraphics.drawGBAFrame(e)},this.initSound=function(){},this.pauseSound=function(){},this.resetSound=function(){this.vbaSound.resetSound()},this.resumeSound=function(){},this.writeSound=function(e,t){return this.vbaSound.writeSound(e,t)},this.setThrottleSound=function(e,t){},this.getSaveSize=function(){return 0},this.commitFlash=this.commitEeprom=function(e,t){return 0},this.restoreSaveMemory=function(e,t){return 0},this.isKeyDown=function(e){return this.emulatorManager.isKeyPressed(e)},this.getJoypad=function(e){var t=0;return this.isKeyDown("A")&&(t|=1),this.isKeyDown("B")&&(t|=2),this.isKeyDown("SELECT")&&(t|=4),this.isKeyDown("START")&&(t|=8),this.isKeyDown("RIGHT")&&(t|=16),this.isKeyDown("LEFT")&&(t|=32),this.isKeyDown("UP")&&(t|=64),this.isKeyDown("DOWN")&&(t|=128),this.isKeyDown("R")&&(t|=256),this.isKeyDown("L")&&(t|=512),48===(48&t)&&(t&=-49),192===(192&t)&&(t&=-193),t},this.dbgOutput=function(e,t){return console.log("dbgOutput",e,t)},this.start=function(){this.vbaGraphics.initScreen()?(this.vbaGraphics.drawFrame(),this.vbaSound=new l(window.gbaninja),this.VBA_start(),i=window.requestAnimationFrame(u)):console.error("You need to enable WebGL!")},this.destroy=function(){window.cancelAnimationFrame(i),this.VBA_stop(),window.VBAInterface=null}}},117:function(e,t,n){e.exports=n(205)},122:function(e,t,n){},197:function(e,t,n){},199:function(e,t,n){},201:function(e,t,n){},205:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),o=n(6),r=n.n(o),s=n(211),u=(n(122),n(9)),c=n(10),l=n(12),d=n(11),h=n(13),m=n(210),p=n(71),f=n.n(p),g=n(95),y=n(213),v=n(7),b=n(72),w=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).lastTouchEnd=0,n.onContextMenu=n.onContextMenu.bind(Object(v.a)(Object(v.a)(n))),n.onScroll=n.onScroll.bind(Object(v.a)(Object(v.a)(n))),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){window.scrollTo(0,0),Object(b.disableBodyScroll)(document.querySelector("#root")),document.addEventListener("contextmenu",this.onContextMenu),window.addEventListener("scroll",this.onScroll)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("contextmenu",this.onContextMenu),window.removeEventListener("scroll",this.onScroll),Object(b.clearAllBodyScrollLocks)()}},{key:"touchstartHandle",value:function(e){e.touches.length>1&&e.preventDefault()}},{key:"touchmoveHandle",value:function(e){1!==e.scale&&e.preventDefault()}},{key:"onContextMenu",value:function(e){e.preventDefault()}},{key:"onScroll",value:function(e){window.scrollTo(0,0)}},{key:"render",value:function(){var e=["noselect",this.props.className?this.props.className:""].join(" ");return i.a.createElement("div",{ref:!!this.props.ref&&this.props.ref,className:e,style:this.props.style?this.props.style:{}},this.props.children)}}]),t}(i.a.Component),A=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(m.a,{style:{position:"relative",height:"100vh",backgroundColor:"transparent",textAlign:"center"}},i.a.createElement(w,null,i.a.createElement("div",{style:{position:"absolute",width:"100%",top:"50%",left:0,marginTop:"-66px"}},i.a.createElement("div",{style:{marginBottom:"10px"}},i.a.createElement("img",{src:"favicon.ico",alt:"Splash logo",style:{maxWidth:"100px"}})),i.a.createElement("div",{className:"ant-tag",style:{marginRight:0}},"GameBoy Advance")),i.a.createElement("div",{style:{position:"absolute",width:"100%",bottom:"100px",left:0}},i.a.createElement(y.a,null))))}}]),t}(i.a.Component);var E=function(e){return function(t){function n(e){var t;return Object(u.a)(this,n),(t=Object(l.a)(this,Object(d.a)(n).call(this,e))).state={loading:!0},t}return Object(h.a)(n,t),Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=Object(g.a)(f.a.mark(function e(){var t=this;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{setTimeout(function(){t.setState({loading:!1})},1500)}catch(n){console.log(n),this.setState({loading:!1})}case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.loading?i.a.createElement(A,null):i.a.createElement(e,this.props)}}]),n}(i.a.Component)},k=n(207),S=n(212),R=n(209),j=n(206),_=n(100),B=n.n(_),O=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.location.pathname;return i.a.createElement(m.a.Header,{style:{height:"inherit",lineHeight:"inherit"}},i.a.createElement(R.a,{theme:"dark",selectedKeys:[e],mode:"horizontal",style:{lineHeight:"/play"===e?"25px":"46px"}},i.a.createElement(R.a.Item,{key:"/"},i.a.createElement(k.a,{to:"/"},i.a.createElement(j.a,{type:"home"}),"Home")),i.a.createElement(R.a.Item,{key:"/play"},i.a.createElement(k.a,{to:"/play"},i.a.createElement("i",{className:"anticon",style:{verticalAlign:"text-top",width:"22px"}},i.a.createElement("img",{src:B.a,alt:"Play"})),"Play"))))}}]),t}(a.Component),M=Object(S.a)(O),x=n(208),T=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null)}}]),t}(a.Component),C=n(109),L=n(111),D=n.n(L),P=function(e){function t(e){var n;return Object(u.a)(this,t),console.log("Emulator.constructor called"),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).parent=e.parent,n.emulatorManager=new C.a(Object(v.a)(Object(v.a)(n))),n.onClick=n.onClick.bind(Object(v.a)(Object(v.a)(n))),n.onDrop=n.onDrop.bind(Object(v.a)(Object(v.a)(n))),n.onDragOver=n.onDragOver.bind(Object(v.a)(Object(v.a)(n))),n.inputFileOnChange=n.inputFileOnChange.bind(Object(v.a)(Object(v.a)(n))),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.emulatorManager.start()}},{key:"componentWillUnmount",value:function(){console.log("Emulator.componentWillUnmount"),this.emulatorManager.destroy()}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"onDrop",value:function(e){e.preventDefault();var t=e.dataTransfer.files[0];t&&this.emulatorManager.loadRomFile(t)}},{key:"onClick",value:function(e){e.preventDefault(),this.refs.inputFile.click()}},{key:"inputFileOnChange",value:function(e){e.preventDefault();var t=e.target.files[0];t&&this.emulatorManager.loadRomFile(t)}},{key:"render",value:function(){return i.a.createElement("div",{className:"emu-wrapper",style:{backgroundImage:"url("+D.a+")"}},i.a.createElement("script",{id:"2d-vertex-shader",type:"x-shader/x-vertex"},"\n            attribute vec2 a_position;\n            varying highp vec2 v_textureCoord;\n\n            void main() {\n              /**\n               * This scales the quad so that the screen texture fits the viewport.\n               * The texture is 256 * 256, but only 240 * 160 is used. The quad is 2*2, centered on (0,0)\n               */\n              gl_Position = vec4((a_position.x * 2.0 * 1.0666) - 1.0, (a_position.y * 2.0 * 1.6) * -1.0 + 1.0, 0, 1);\n              v_textureCoord = vec2(a_position.x, a_position.y);\n            }\n            "),i.a.createElement("script",{id:"2d-fragment-shader",type:"x-shader/x-fragment"},"\n          varying highp vec2 v_textureCoord;\n\n          uniform sampler2D u_sampler;\n\n          void main(void) {\n            gl_FragColor = texture2D(u_sampler, vec2(v_textureCoord.s, v_textureCoord.t));\n          }\n            "),i.a.createElement("div",{ref:"screen",className:"screen",onClick:this.onClick,onDrop:this.onDrop,onDragOver:this.onDragOver}),i.a.createElement("input",{ref:"inputFile",type:"file",accept:".gb,.gba,.gbc,.zip",style:{display:"none"},onChange:this.inputFileOnChange}))}}]),t}(i.a.Component),F=n(112),G=n.n(F),N=(n(197),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).isPushed=!1,n.hasSupportTouch="ontouchstart"in document.documentElement,n.selfRef=i.a.createRef(),n.emulatorRef=e.parent.emulatorRef,n.emulatorManager=null,n.onMouseDown=n.onMouseDown.bind(Object(v.a)(Object(v.a)(n))),n.onMouseMove=n.onMouseMove.bind(Object(v.a)(Object(v.a)(n))),n.onMouseUp=n.onMouseUp.bind(Object(v.a)(Object(v.a)(n))),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.emulatorManager=this.emulatorRef.current.emulatorManager;var e=this.selfRef.current;this.hasSupportTouch?(e.addEventListener("touchstart",this.onMouseDown),e.addEventListener("touchmove",this.onMouseMove),e.addEventListener("touchend",this.onMouseUp)):(window.addEventListener("mouseup",this.onMouseUp),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mousemove",this.onMouseMove),e.addEventListener("mouseup",this.onMouseUp))}},{key:"componentWillUnmount",value:function(){var e=this.selfRef.current;e.removeEventListener("mousedown",this.onMouseDown),e.removeEventListener("mousemove",this.onMouseMove),e.removeEventListener("mouseup",this.onMouseUp),e.removeEventListener("touchstart",this.onMouseDown),e.removeEventListener("touchmove",this.onMouseMove),e.removeEventListener("touchend",this.onMouseUp),window.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchstart",this.onMouseDown),window.removeEventListener("touchend",this.onMouseUp)}},{key:"onMouseDown",value:function(e){console.log("%s",e.type,e);var t=e.target.getAttribute("data-joykey");t&&(e.preventDefault(),this.isPushed=!0,this.emulatorManager.isKeyPressed(t)||this.emulatorManager.onPressed(t))}},{key:"onMouseMove",value:function(e){if(console.log("%s",e.type),this.isPushed){e.preventDefault();var t=e.clientX,n=e.clientY;if("touchmove"===e.type){for(var a=e.touches,i=[],o=0;o<a.length;o++){var r=a[o],s=document.elementFromPoint(r.clientX,r.clientY);if(s){var u=s.getAttribute("data-joykey");!u||u in i||i.push(u)}}for(var c=this.emulatorManager.keyCodes,l=Object.keys(c),d=0;d<l.length;d++){var h=l[d];h in i||this.emulatorManager.isKeyPressed(h)&&this.emulatorManager.onReleased(h)}var m=e.changedTouches[0];t=m.clientX,n=m.clientY}var p=document.elementFromPoint(t,n);if(p){var f=p.getAttribute("data-joykey");f&&(this.emulatorManager.isKeyPressed(f)||this.emulatorManager.onPressed(f))}}}},{key:"onMouseUp",value:function(e){if(console.log("%s",e.type,e),this.isPushed)if(this.isPushed=!1,"mouseup"!==e.type)if("touchend"===e.type&&e.touches.length<=1)this.emulatorManager.releaseAllKey();else{var t=e.target.getAttribute("data-joykey");t&&this.emulatorManager.onReleased(t)}else this.emulatorManager.releaseAllKey()}},{key:"setActive",value:function(e,t){for(var n=this.selfRef.current.getElementsByTagName("button"),a=0;a<n.length;a++){var i=n[a];i&&i.getAttribute("data-joykey")===e&&(t?i.classList.add("active"):i.classList.remove("active"))}}},{key:"render",value:function(){return i.a.createElement("div",{ref:this.selfRef,className:"joystick"},i.a.createElement("button",{className:"rectangle-btn","data-joykey":"L"},"L"),i.a.createElement("button",{className:"rectangle-btn","data-joykey":"R"},"R"),i.a.createElement("div",{className:"console-dpad-btn",style:{backgroundImage:"url("+G.a+")"}},i.a.createElement("button",{className:"dpad-btn","data-joykey":"LEFT"}),i.a.createElement("button",{className:"dpad-btn","data-joykey":"UP"}),i.a.createElement("button",{className:"dpad-btn","data-joykey":"RIGHT"}),i.a.createElement("button",{className:"dpad-btn","data-joykey":"DOWN"})),i.a.createElement("button",{className:"circle-btn","data-joykey":"A"},"A"),i.a.createElement("button",{className:"circle-btn","data-joykey":"B"},"B"),i.a.createElement("button",{className:"rectangle-btn","data-joykey":"START"},"Start"),i.a.createElement("button",{className:"rectangle-btn","data-joykey":"SELECT"},"Select"))}}]),t}(i.a.Component)),U=function(){function e(t){Object(u.a)(this,e),this.gamepads=[],this.rafId=null,this.scanIntervalId=null,this.selectedIndex=0,console.log("GamepadManager.constructor called"),this.parentRef=t,this.update=this.update.bind(this),this.onGamepadConnected=this.onGamepadConnected.bind(this),this.onGamepadDisconnected=this.onGamepadDisconnected.bind(this),this.scanGamepads=this.scanGamepads.bind(this)}return Object(c.a)(e,[{key:"start",value:function(){window.addEventListener("gamepadconnected",this.onGamepadConnected),window.addEventListener("gamepaddisconnected",this.onGamepadDisconnected),this.scanIntervalId=setInterval(this.scanGamepads,500)}},{key:"destroy",value:function(){console.log("GamepadManager.destroy called"),window.removeEventListener("gamepadconnected",this.onGamepadConnected),window.removeEventListener("gamepaddisconnected",this.onGamepadDisconnected),window.cancelAnimationFrame(this.rafId),clearInterval(this.scanIntervalId)}},{key:"update",value:function(){console.log("GamepadManager.update called");var e=this.gamepads[this.selectedIndex];console.log(e);for(var t=0;t<e.buttons.length;t++){var n=e.buttons[t],a=1===n;"object"===typeof n&&(a=n.pressed,n=n.value),console.log(n,a)}this.rafId=window.requestAnimationFrame(this.update)}},{key:"scanGamepads",value:function(){console.log("GamepadManager.scanGamepads called");for(var e=navigator.getGamepads?navigator.getGamepads():[],t=0;t<e.length;t++)e[t]&&(e[t].index in this.gamepads?this.gamepads[t]=e[t]:this.addGamepad(e[t]))}},{key:"addGamepad",value:function(e){this.gamepads[e.index]=e,this.rafId=window.requestAnimationFrame(this.update),console.log("GamepadManager.start.id:"+this.rafId)}},{key:"onGamepadConnected",value:function(e){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.gamepad.index,e.gamepad.id,e.gamepad.buttons.length,e.gamepad.axes.length)}},{key:"onGamepadDisconnected",value:function(e){delete this.gamepads[e.gamepad.index]}}]),e}(),V=function(){function e(t){Object(u.a)(this,e),this.parent=t,this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.keyMapConfig={A:90,B:88,SELECT:83,START:65,RIGHT:39,LEFT:37,UP:38,DOWN:40,R:87,L:81},this.pushedList={}}return Object(c.a)(e,[{key:"start",value:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.emulatorManager=this.parent.emulatorRef.current.emulatorManager}},{key:"destroy",value:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}},{key:"getJoykey",value:function(e){var t=this;return Object.keys(this.keyMapConfig).find(function(n){return t.keyMapConfig[n]===e})}},{key:"setActiveJoykey",value:function(e,t){this.parent.joystickRef.current.setActive(e,t)}},{key:"onKeyDown",value:function(e){var t=e.keyCode;if(this.pushedList[t])e.preventDefault();else{var n=this.getJoykey(t);n&&(e.preventDefault(),this.pushedList[t]=!0,this.setActiveJoykey(n,!0),this.emulatorManager.onPressed(n))}}},{key:"onKeyUp",value:function(e){var t=e.keyCode,n=this.getJoykey(t);n&&(e.preventDefault(),this.pushedList[t]=!1,this.setActiveJoykey(n,!1),this.emulatorManager.onReleased(n))}}]),e}(),I=n(113),K=n.n(I),W=n(114),H=n.n(W),X=(n(199),function(e){function t(e){var n;return Object(u.a)(this,t),console.log("Play.constructor called"),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).gamePadManager=null,n.selfRef=i.a.createRef(),n.joystickRef=i.a.createRef(),n.emulatorRef=i.a.createRef(),n.updateWindowDimensions=n.updateWindowDimensions.bind(Object(v.a)(Object(v.a)(n))),window.getGamepads&&(n.gamePadManager=new U(Object(v.a)(Object(v.a)(n)))),n.keyboardManager=new V(Object(v.a)(Object(v.a)(n))),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),this.gamePadManager&&this.gamePadManager.start(),this.keyboardManager.start()}},{key:"componentWillUnmount",value:function(){console.log("Play.componentWillUnmount"),window.removeEventListener("resize",this.updateWindowDimensions),this.gamePadManager&&this.gamePadManager.destroy(),this.keyboardManager.destroy()}},{key:"updateWindowDimensions",value:function(){var e=this;console.log("updateWindowDimensions called");var t=setTimeout(function(){clearTimeout(t);var n=e.selfRef.current;window.innerWidth>window.innerHeight?n.classList.contains("landscape")||(n.classList.remove("portrait"),n.classList.add("landscape"),n.style.backgroundImage="url("+K.a+")"):n.classList.contains("portrait")||(n.classList.remove("landscape"),n.classList.add("portrait"),n.style.backgroundImage="none")},250)}},{key:"render",value:function(){return i.a.createElement(w,{style:{backgroundImage:"url("+H.a+")"}},i.a.createElement("div",{ref:this.selfRef,className:"play-wrapper"},i.a.createElement(P,{ref:this.emulatorRef,parent:this}),i.a.createElement(N,{ref:this.joystickRef,parent:this})))}}]),t}(i.a.Component)),q=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(m.a.Content,null,i.a.createElement(x.a,{exact:!0,path:"/",component:T}),i.a.createElement(x.a,{exact:!0,path:"/play",component:X}))}}]),t}(a.Component),z=function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return"/play"!==this.props.location.pathname&&i.a.createElement(m.a.Footer,null)}}]),t}(a.Component),J=Object(S.a)(z),Y=(n(201),n(203),E(function(e){function t(){return Object(u.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(m.a,null,i.a.createElement(M,null),i.a.createElement(m.a,null,i.a.createElement(J,null),i.a.createElement(q,null)),i.a.createElement(J,null))}}]),t}(a.Component)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame,window.AudioContext=window.AudioContext||window.webkitAudioContext,navigator.getGamepads=navigator.getGamepads||navigator.webkitGamepads||navigator.webkitGetGamepads,r.a.render(i.a.createElement(s.a,{basename:"".concat("/GameBoyAdvance","/#")},i.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[117,2,1]]]);
//# sourceMappingURL=main.681e947d.chunk.js.map